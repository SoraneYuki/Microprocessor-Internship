#define ls138A 30
#define ls138B 31
#define ls138C 32

#define row 8
#define col 8

#define u_0 {0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 1, 1, 1, 1, 0, 0,\
             0, 1, 0, 1, 1, 0, 1, 0,\
             1, 0, 0, 1, 1, 0, 0, 1,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0}

#define u_1 {0, 1, 0, 1, 1, 0, 1, 0,\
             1, 0, 0, 1, 1, 0, 0, 1,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0}

#define u_2 {0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0}

#define u_3 {0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 1, 1, 1, 1, 0, 0}

#define u_4 {0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 1, 1, 1, 1, 0, 0,\
             0, 1, 0, 1, 1, 0, 1, 0,\
             1, 0, 0, 1, 1, 0, 0, 1}

#define u_5 {0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 1, 1, 1, 1, 0, 0,\
             0, 1, 0, 1, 1, 0, 1, 0,\
             1, 0, 0, 1, 1, 0, 0, 1,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0}

#define d_0 {0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             1, 0, 0, 1, 1, 0, 0, 1,\
             0, 1, 0, 1, 1, 0, 1, 0,\
             0, 0, 1, 1, 1, 1, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0}

#define d_1 {0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             1, 0, 0, 1, 1, 0, 0, 1,\
             0, 1, 0, 1, 1, 0, 1, 0}

#define d_2 {0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0}

#define d_3 {0, 0, 1, 1, 1, 1, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0}

#define d_4 {1, 0, 0, 1, 1, 0, 0, 1,\
             0, 1, 0, 1, 1, 0, 1, 0,\
             0, 0, 1, 1, 1, 1, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0}

#define d_5 {0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             1, 0, 0, 1, 1, 0, 0, 1,\
             0, 1, 0, 1, 1, 0, 1, 0,\
             0, 0, 1, 1, 1, 1, 0, 0,\
             0, 0, 0, 1, 1, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0}

#define l_0 {0, 0, 0, 1, 0, 0, 0, 0,\
             0, 0, 1, 0, 0, 0, 0, 0,\
             0, 1, 0, 0, 0, 0, 0, 0,\
             1, 1, 1, 1, 1, 1, 1, 1,\
             1, 1, 1, 1, 1, 1, 1, 1,\
             0, 1, 0, 0, 0, 0, 0, 0,\
             0, 0, 1, 0, 0, 0, 0, 0,\
             0, 0, 0, 1, 0, 0, 0, 0}

#define l_1 {0, 1, 0, 0, 0, 0, 0, 0,\
             1, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             1, 1, 1, 1, 1, 1, 0, 0,\
             1, 1, 1, 1, 1, 1, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             1, 0, 0, 0, 0, 0, 0, 0,\
             0, 1, 0, 0, 0, 0, 0, 0}

#define l_2 {0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             1, 1, 1, 1, 0, 0, 0, 0,\
             1, 1, 1, 1, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0}

#define l_3 {0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 1,\
             1, 1, 0, 0, 0, 0, 1, 1,\
             1, 1, 0, 0, 0, 0, 1, 1,\
             0, 0, 0, 0, 0, 0, 0, 1,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0}

#define l_4 {0, 0, 0, 0, 0, 0, 0, 1,\
             0, 0, 0, 0, 0, 0, 1, 0,\
             0, 0, 0, 0, 0, 1, 0, 0,\
             0, 0, 0, 0, 1, 1, 1, 1,\
             0, 0, 0, 0, 1, 1, 1, 1,\
             0, 0, 0, 0, 0, 1, 0, 0,\
             0, 0, 0, 0, 0, 0, 1, 0,\
             0, 0, 0, 0, 0, 0, 0, 1}

#define l_5 {0, 0, 0, 0, 0, 1, 0, 0,\
             0, 0, 0, 0, 1, 0, 0, 0,\
             0, 0, 0, 1, 0, 0, 0, 0,\
             0, 0, 1, 1, 1, 1, 1, 1,\
             0, 0, 1, 1, 1, 1, 1, 1,\
             0, 0, 0, 1, 0, 0, 0, 0,\
             0, 0, 0, 0, 1, 0, 0, 0,\
             0, 0, 0, 0, 0, 1, 0, 0}

#define r_0 {0, 0, 0, 0, 1, 0, 0, 0,\
             0, 0, 0, 0, 0, 1, 0, 0,\
             0, 0, 0, 0, 0, 0, 1, 0,\
             1, 1, 1, 1, 1, 1, 1, 1,\
             1, 1, 1, 1, 1, 1, 1, 1,\
             0, 0, 0, 0, 0, 0, 1, 0,\
             0, 0, 0, 0, 0, 1, 0, 0,\
             0, 0, 0, 0, 1, 0, 0, 0}

#define r_1 {0, 0, 0, 0, 0, 0, 1, 0,\
             0, 0, 0, 0, 0, 0, 0, 1,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 1, 1, 1, 1, 1, 1,\
             0, 0, 1, 1, 1, 1, 1, 1,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 1,\
             0, 0, 0, 0, 0, 0, 1, 0}

#define r_2 {0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 1, 1, 1, 1,\
             0, 0, 0, 0, 1, 1, 1, 1,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0}

#define r_3 {0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             1, 0, 0, 0, 0, 0, 0, 0,\
             1, 1, 0, 0, 0, 0, 1, 1,\
             1, 1, 0, 0, 0, 0, 1, 1,\
             1, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0,\
             0, 0, 0, 0, 0, 0, 0, 0}

#define r_4 {1, 0, 0, 0, 0, 0, 0, 0,\
             0, 1, 0, 0, 0, 0, 0, 0,\
             0, 0, 1, 0, 0, 0, 0, 0,\
             1, 1, 1, 1, 0, 0, 0, 0,\
             1, 1, 1, 1, 0, 0, 0, 0,\
             0, 0, 1, 0, 0, 0, 0, 0,\
             0, 1, 0, 0, 0, 0, 0, 0,\
             1, 0, 0, 0, 0, 0, 0, 0}

#define r_5 {0, 0, 1, 0, 0, 0, 0, 0,\
             0, 0, 0, 1, 0, 0, 0, 0,\
             0, 0, 0, 0, 1, 0, 0, 0,\
             1, 1, 1, 1, 1, 1, 0, 0,\
             1, 1, 1, 1, 1, 1, 0, 0,\
             0, 0, 0, 0, 1, 0, 0, 0,\
             0, 0, 0, 1, 0, 0, 0, 0,\
             0, 0, 1, 0, 0, 0, 0, 0}

boolean word_array[24][row][col] = {u_0, u_1, u_2, u_3, u_4, u_5, d_0, d_1, d_2, d_3, d_4, d_5, l_0, l_1, l_2, l_3, l_4, l_5, r_0, r_1, r_2, r_3, r_4, r_5};
boolean led[row][col];

byte rowpin[row] = {2, 3, 4, 5, 6, 7, 8, 9};

int dis = 0;

int joypinx = A1;
int joypiny = A2;

int value = 0;
int xzero = 0;
int yzero = 0;

void setup()
{
    // put your setup code here, to run once:

    xzero = analogRead(joypinx);
    yzero = analogRead(joypiny);

    pinMode(ls138A, OUTPUT);
    pinMode(ls138B, OUTPUT);
    pinMode(ls138C, OUTPUT);

    for (int i = 0; i < 8; i++)
    {

        pinMode(rowpin[i], OUTPUT);
    }

    clearled();
    pinMode(A14, OUTPUT);
    digitalWrite(A14, LOW);
}

void loop()
{
    // put your main code here, to run repeatedly:

    int x, y, value;

    value = analogRead(joypinx);
    x = value - xzero;

    value = analogRead(joypiny);
    y = value - yzero;

    wordtoled(dis);
    displayled(led, 100);

    if (x > 300)
    {

        dis++;

        if (dis > 11 || dis <= 5)
        {

            dis = 6;

        }

    }
    else if (x < -300)
    {

        dis++;

        if (dis > 5)
        {
        
            dis = 0;
        
        }

    }
    else if(y > 300)
    {

        dis++;

        if (dis > 17 || dis <= 11)
        {

            dis = 12;

        }

    }
    else if(y < -300)
    {

        dis++;

        if (dis > 23 || dis <= 17)
        {

            dis = 18;

        }

    }
    
}

void wordtoled(int n)
{

    for (int i = 0; i < row; i++)
    {

        for (int j = 0; j < col; j++)
        {

            led[i][j] = word_array[n][i][j];
        }
    }
}

void clearled()
{

    for (int i = 0; i < row; i++)
    {

        digitalWrite(rowpin[i], LOW);
    }
}

void displayled(boolean led[row][col], int continue_time)
{

    for (int k = 0; k < continue_time; k++)
    {

        for (int i = 0; i < col; i++)
        {

            clearled();
            low_74138pin(i);

            for (int j = 0; j < row; j++)
            {

                if (led[j][i] == 1)
                {

                    digitalWrite(rowpin[j], HIGH);
                }
            }
        }
    }
}

void low_74138pin(int num)
{

    switch (num)
    {

    case 0:
        digitalWrite(ls138A, LOW);
        digitalWrite(ls138B, LOW);
        digitalWrite(ls138C, LOW);
        break;

    case 1:
        digitalWrite(ls138A, HIGH);
        digitalWrite(ls138B, LOW);
        digitalWrite(ls138C, LOW);
        break;

    case 2:
        digitalWrite(ls138A, LOW);
        digitalWrite(ls138B, HIGH);
        digitalWrite(ls138C, LOW);
        break;

    case 3:
        digitalWrite(ls138A, HIGH);
        digitalWrite(ls138B, HIGH);
        digitalWrite(ls138C, LOW);
        break;

    case 4:
        digitalWrite(ls138A, LOW);
        digitalWrite(ls138B, LOW);
        digitalWrite(ls138C, HIGH);
        break;

    case 5:
        digitalWrite(ls138A, HIGH);
        digitalWrite(ls138B, LOW);
        digitalWrite(ls138C, HIGH);
        break;

    case 6:
        digitalWrite(ls138A, LOW);
        digitalWrite(ls138B, HIGH);
        digitalWrite(ls138C, HIGH);
        break;

    case 7:
        digitalWrite(ls138A, HIGH);
        digitalWrite(ls138B, HIGH);
        digitalWrite(ls138C, HIGH);
        break;
    }
}